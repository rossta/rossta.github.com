<!doctype html>
<html>
  <head>
    <title>Fill out Google Forms from the command line - rossta.net</title>
<meta name="description" content="A tutorial for writing a CasperJS script to fill out a Google Form, which is also available now as an npm package called &quot;form-to-terminal&quot;" />
<meta name="keywords" content="JavaScript, Node" />
<meta name="site" content="rossta.net" />
<meta property="og:site_name" content="rossta.net" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="Ross Kaffenberger" />
<meta name="twitter:description" content="A tutorial for writing a CasperJS script to fill out a Google Form, which is also available now as an npm package called &quot;form-to-terminal&quot;" />
<meta name="twitter:image:src" content="https://rossta.net/assets/images/blog/stock/coding-a-pexels-photo-b323cc54.jpg" />
<meta name="twitter:title" content="Fill out Google Forms from the command line" />
<meta property="og:description" content="A tutorial for writing a CasperJS script to fill out a Google Form, which is also available now as an npm package called &quot;form-to-terminal&quot;" />
<meta property="og:image" content="https://rossta.net/assets/images/blog/stock/coding-a-pexels-photo-b323cc54.jpg" />
<meta property="og:title" content="Fill out Google Forms from the command line" />
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="mobile-web-app-capable" content="yes">

    <link rel="manifest" href="/manifest.json" />
    <link rel="apple-touch-icon"     href="/apple-touch-icon.png" />
    <link rel="icon"                 href="/touch-icon-192x192.png" />
    <link rel="icon" sizes="192x192" href="/touch-icon-192x192.png" />
    <link rel="icon" sizes="144x144" href="/touch-icon-144x144.png" />
    <link rel="icon" sizes="96x96"   href="/touch-icon-96x96.png" />
    <link rel="icon" sizes="72x72"   href="/touch-icon-72x72.png" />

    <link rel="pingback" href="https://webmention.io/rossta.net/xmlrpc" />
    <link rel="webmention" href="https://webmention.io/rossta.net/webmention" />

    <script type="text/javascript" src="//use.typekit.net/ned0mml.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
    <link href="/assets/stylesheets/index.bundle-bc0b1daa.css" rel="stylesheet" />
    <script src="/assets/javascripts/head.bundle-12bac7ac.js"></script>
    <link href="/assets/images/turtle-favicon.ico" rel="icon" type="image/ico" />
  </head>
  <body id="application" class="typekit">
    <nav id="welcome-nav" class="top-bar" data-topbar>
  <ul class="title-area">
    <li class="name">
      <h1><a class="logo" href="/"><img src="/assets/images/turtle-logo-096698b6.svg" alt="Turtle logo" /><span>rossta.net</span></a></h1>
    </li>
    <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
  </ul>

  <section class="top-bar-section">
    <ul class="left">
      <li class="nav"><a href="/blog">blog</a></li>
      <li class="nav"><a href="/series">series</a></li>
      <li class="nav"><a href="/talks">talks</a></li>
      <li class="nav"><a href="/projects">projects</a></li>
      <li class="nav"><a href="/about">about</a></li>
      <li class="nav"><a href="/feed.xml">feed</a></li>
    </ul>
  </section>
</nav>

    <div class="row">
      <section id="main" role="main" class="large-12 small-12 columns">
          <section id="blog" class="margin-bottom double">
    <article class="post margin-bottom double">
      <header class="page-header with-summary">
  <h1>
    Fill out Google Forms from the command line
  </h1>
    <h3>
      Using CasperJS to automate webpage interaction
    </h3>
</header>

        <p><img src="/assets/images/blog/stock/coding-a-pexels-photo-b323cc54.jpg" alt="Coding a pexels photo" /></p>

      <p>To give you some idea about what a geek I am, when <a href="https://twitter.com/saronyitbarek">Saron</a> asked me to fill out a form to submit blog posts to the <a href="http://www.codenewbie.org/blogs/submit-to-the-codenewbie-newsletter">CodeNewbie Newsletter</a>, I thought, &quot;what if I could automate that?&quot; I happen to spend a lot of time in a terminal and thinking about webpage interaction, so...</p>

<p>Instead of filling out the form for my last article, I ended up creating a tool to submit a Google Form from the command line. At its core, it&#39;s a <a href="http://casperjs.org/">CasperJS</a> script available as an npm package. It&#39;s called <a href="https://github.com/rossta/form-to-terminal"><code>form-to-terminal</code></a>.</p>

<p>To use <code>form-to-terminal</code>, install it via npm and use the executable <code>ftt</code> along with a url to a Google Form url:</p>

<pre><code class="bash"># Open a terminal and enter the following commands after the prompt ($):
$ npm install -g form-to-terminal
$ ftt [Google Form Url]
</code></pre>

<p>This assumes that you&#39;ve already installed <a href="https://nodejs.org/en/download/package-manager/">nodejs</a>,  <a href="http://docs.casperjs.org/en/latest/installation.html">CasperJS</a>, and its pre-requisites.</p>

      <h2 id="casper-the-friendly-ghost" class="title">
        <a name="casper-the-friendly-ghost" class="anchor" href="#casper-the-friendly-ghost">       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
       <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
       </svg>
</a>
        Casper, the friendly ghost
      </h2>
    
<p>CasperJS is actually just a wrapper around <a href="http://phantomjs.org/">PhantomJS</a>, which provides
fully-featured API for interacting with webpages from JavaScript.</p>

<p>CasperJS makes this scripting more pleasant by providing some syntactic sugar for dealing
with multi-stage interactions and waiting for asynchronous actions. In other
words, I could&#39;ve done this with just using PhantomJS, but the code I needed to
write got a whole lot easier by using the CasperJS module on top of it.</p>

      <h2 id="a-closer-look" class="title">
        <a name="a-closer-look" class="anchor" href="#a-closer-look">       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
       <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
       </svg>
</a>
        A closer look
      </h2>
    
<p>Let&#39;s look at some sample code. What follows are simplified excerpts from the <code>form-to-terminal</code> CasperJS script.</p>

<p>Given a <code>url</code> to a Google Form, first we <code>start</code> the webpage interaction, which waits to complete
before moving to the next step.</p>

<pre><code class="javascript">var casper = require(&quot;casper&quot;).create();

casper.start(url, function() {
  this.waitForSelector(&quot;form&quot;);
});
</code></pre>

<p>To provide the command line interface with some context, the script parses the
page for the form title to display back to the command line.</p>

<pre><code class="javascript">var formTitle;

casper.then(function() {
  formTitle = this.evaluate(getFormTitle);
});
</code></pre>

<p>Next, we want to allow human interaction with each input one-by-one, so we parse
the form for the text inputs and their labels so we can ask the user to enter answers back into the
terminal using <code>readLine</code>:</p>

<pre><code class="javascript">var system = require(&#39;system&#39;);
var answers;

casper.then(function() {
  var page = this;
  page.echo(&quot;Please fill out &quot; + formTitle);
  page.echo(&quot;----------------&quot; + formTitle.length);
  answers = page.evaluate(getFormInputs)

  answers.filter(function(input) {
    return input.type == &quot;text&quot;;
  }).map(function(input, i) {
    page.echo(&quot;&quot;);
    page.echo(&quot;&quot;+(i+1)+&quot;) &quot;+input.label+&quot;:&quot;);

    input.value = system.stdin.readLine();
t
    return input;
  });
});m
</code></pre>

<p>Awesome! Now we just need to pass the <code>answers</code> back to the webpage and submit
the form. CasperJS makes it easy to do this with additional args to
<code>this.evaluate</code> in the <code>casper</code> context:</p>

<pre><code class="javascript">casper.then(function() {
  this.evaluate(submitAnswers, {answers: answers});
  page.echo(&quot;&quot;);
  this.echo(&quot;Thanks!&quot;);
});
</code></pre>

<p>Check out the full <a href="https://github.com/rossta/form-to-terminal/blob/96a4dd8be4b071b5bfb5adb50676a6383c685240/index.js">CasperJS script</a> to see how <code>form-to-terminal</code> interacts with Google Forms in more detail.</p>

      <h2 id="command-line-node" class="title">
        <a name="command-line-node" class="anchor" href="#command-line-node">       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
       <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
       </svg>
</a>
        Command line node
      </h2>
    
<p>I wanted to make this work for others on the command line as an npm package. To
get this to work, we have to understand that <code>casperjs</code> is already its own
process. To make it work from <code>node</code>, I needed to spawn the <code>casperjs</code> while
passing arguments from node. I also needed to make sure that the <code>stdin</code>
stream is piped from parent (node) to the child (casperjs) process so that we our answers
for the form inputs end up on the web page.</p>

<p>The key pieces of the command line tool are shown below:</p>

<pre><code class="javascript">const child = spawn(&#39;casperjs&#39;, [&#39;index.js&#39;].concat(urls));

child.stdin.setEncoding(&#39;utf-8&#39;);
child.stdout.pipe(process.stdout);
process.stdin.pipe(child.stdin);
child.on(&#39;exit&#39;, process.exit);
</code></pre>

<p>The <code>urls</code> represent the set of Google Form urls with which the CasperJS script
will interact. The line <code>process.stdin.pipe(child.stdin);</code> ensures the text we
enter on the command line is passed to CasperJS.</p>

      <h2 id="going-further" class="title">
        <a name="going-further" class="anchor" href="#going-further">       <svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16">
       <path d="M4 9h1v1h-1c-1.5 0-3-1.69-3-3.5s1.55-3.5 3-3.5h4c1.45 0 3 1.69 3 3.5 0 1.41-0.91 2.72-2 3.25v-1.16c0.58-0.45 1-1.27 1-2.09 0-1.28-1.02-2.5-2-2.5H4c-0.98 0-2 1.22-2 2.5s1 2.5 2 2.5z m9-3h-1v1h1c1 0 2 1.22 2 2.5s-1.02 2.5-2 2.5H9c-0.98 0-2-1.22-2-2.5 0-0.83 0.42-1.64 1-2.09v-1.16c-1.09 0.53-2 1.84-2 3.25 0 1.81 1.55 3.5 3 3.5h4c1.45 0 3-1.69 3-3.5s-1.5-3.5-3-3.5z"></path>
       </svg>
</a>
        Going further
      </h2>
    
<p><code>form-to-terminal</code> (as of version 1.0.2) only supports Google Forms and only
fully those with text inputs. It&#39;s likely quite buggy - for example, it doesn&#39;t
currently check that you&#39;ve filled out all required fields, nor does it check
for validations errors after you&#39;ve submitted the form - but, hey, it&#39;s a start.
Go ahead and <a href="https://github.com/rossta/form-to-terminal">check it out on GitHub</a> and contribute some improvements!</p>

<p>CasperJS is a fun tool for automating your workflow and worth a look for
automated testing for web developers.</p>

<p>Of course, I submitted this post to the CodeNewbie Newsletter using
<code>form-to-terminal</code> - how meta? It comes with a built-in shortcut to the
CodeNewbie Google Form, so you can try it too:</p>

<pre><code class="javascript">$ ftt codenewbie
</code></pre>


    </article>
    <hr />
    <section class="margin-bottom double">
      <p>
        Did you like this post? Do me a favor: <a href="https://twitter.com/intent/tweet?text=Fill%20out%20Google%20Forms%20from%20the%20command%20line%20-%20rossta.net&amp;url=https%3A%2F%2Frossta.net%3A4567%2Fblog%2F2016-09-28-fill-out-google-forms-from-the-command-line-with-casperjs.html" target="_blank">share it on Twitter</a>,
          <a href="https://twitter.com/rossta">follow me - @rossta</a>,
          and sign up for my newsletter. Thanks!
        </p>
      </section>
    </section>
    <section class="signup-form-standalone margin-bottom double">
      <!-- Begin MailChimp Signup Form -->
<div class="signup-form">
  <h3>Stay in the LOOP</h3>
  <p>Sign up for my occasional newsletter on Ruby, Javascript, and Elixir for the web!</p>
  <div id="mc_embed_signup">
    <form action="//rossta.us6.list-manage.com/subscribe/post?id=96030b0bda&u=8ce159842b5c98cecb4ebdf16" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
      <div id="mc_embed_signup_scroll">

        <div class="row">
          <div class="large-10 columns">
            <div class="row collapse">
              <div class="large-8 small-7 columns">
                <input type="email" placeholder="Your email..." value="" name="EMAIL" class="required email" id="mce-EMAIL">
              </div>
              <div class="large-4 small-5 columns">
                <input type="submit" value="Sign me up!" name="subscribe" id="mc-embedded-subscribe" class="button postfix">
              </div>
            </div>
          </div>
        </div>

        <div id="mce-responses" class="clear">
          <div class="response" id="mce-error-response" style="display:none"></div>
          <div class="response" id="mce-success-response" style="display:none"></div>
        </div>
        <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
        <div style="position: absolute; left: -5000px;"><input type="text" name="b_8ce159842b5c98cecb4ebdf16_96030b0bda" tabindex="-1" value=""></div>
      </div>

      <input type="hidden" name="SIGNUP" value="https://rossta.net:4567/blog/2016-09-28-fill-out-google-forms-from-the-command-line-with-casperjs.html" />
      <input type="hidden" name="SIGNUP_APP" value="Mailchimp" />
      <input type="hidden" name="SIGNUP_LOCATION" id="signup_location" value="blog/2016-09-28-fill-out-google-forms-from-the-command-line-with-casperjs.html" />
      <input type="hidden" name="SIGNUP_TAGS" id="signup_tags" value="JavaScript,Node" />
    </form>
  </div>
  <!--End mc_embed_signup-->
</div>

    </section>
    <section class="margin-bottom double">
      <p>
        Published on Sep 28, 2016
    </p>
  </section>
    <hr />
    <section class="comments">
      <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname  = "rosskaff";
    var disqus_identifier = "fill-out-google-forms-from-the-command-line-with-casperjs";
    var disqus_title      = "Fill out Google Forms from the command line";
    var disqus_url        = "https://rossta.net/blog/fill-out-google-forms-from-the-command-line-with-casperjs.html";

    var disqus_config = function () {
        this.page.url = disqus_url;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = disqus_identifier; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        this.page.title = disqus_title;
    };

    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//rosskaff.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<!-- <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> -->

    </section>

      </section>
    </div>
    
    <footer>
  <div class="row">
    <img src="/assets/images/turtle-logo-096698b6.svg" class="turtle" alt="Turtle logo" />
    <section class="large-6 columns">
      <h5>Most Popular</h5>
      <ul>
          <li><a href="/blog/web-push-notifications-from-rails.html">Sending Web Push Notifications from Rails</a></li>
          <li><a href="/blog/n+1-is-a-rails-feature.html">N+1 is a Rails feature</a></li>
          <li><a href="/blog/what-i-learned-about-hanami.html">What I learned building an app in Hanami</a></li>
          <li><a href="/blog/how-to-specify-local-ruby-gems-in-your-gemfile.html">How to specify local Ruby gems in your Gemfile</a></li>
          <li><a href="/blog/service-worker-on-rails.html">Service Worker on Rails</a></li>
      </ul>
    </section>
    <section class="large-3 columns">
      <h5>Categories</h5>
      <ul>
          <li><a href="/blog/tags/ruby.html">Ruby</a></li>
          <li><a href="/blog/tags/rails.html">Rails</a></li>
          <li><a href="/blog/tags/javascript.html">JavaScript</a></li>
          <li><a href="/blog/tags/rspec.html">RSpec</a></li>
          <li><a href="/blog/tags/css.html">CSS</a></li>
      </ul>
    </section>
    <section class="large-3 columns">
      <h5>Contact</h5>
      <ul>
        <li><a href="mailto:ross@rossta.net" rel="me">email</a></li>
        <li><a href="https://twitter.com/rossta" rel="me">twitter</a></li>
        <li><a href="https://medium.com/@rossta" rel="me">medium</a></li>
        <li><a href="https://github.com/rossta" rel="me">github</a></li>
        <!-- <li><a href="https://stackoverflow.com/users/771838/rossta?tab=profile" rel="me">stackoverflow</a></li> -->
        <li><a href="https://www.linkedin.com/in/rosskaffenberger" rel="me">linkedin</a></li>
      </ul>
    </section>
  </div>
  <p class="copyright small subtle center">
    Â© 2017 Ross Kaffenberger. All rights reserved.
  </p>
</footer>

    <script src="/assets/javascripts/index.bundle-720ed250.js"></script>
    
    <script type="text/javascript">
!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
analytics.load("NdBtrprkAGAjQryMShljRdVf90saElAU");
analytics.page()
window.$.tracking.flush(analytics);
}}();
</script>

  </body>
</html>
